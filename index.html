<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoodScape Pro+ | Advanced Emotional Wellness Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --warm-orange: #ff9a3c;
            --soft-yellow: #ffd166;
            --cozy-red: #ef476f;
            --calm-purple: #9d4edd;
            --peace-blue: #118ab2;
            --energetic-pink: #ff4d8d;
            --reflective-teal: #06d6a0;
            --dark-bg: #0a0a0a;
            --card-bg: rgba(25, 25, 35, 0.92);
            --text-light: #f8f9fa;
            --text-dim: #adb5bd;
            --transition-slow: 1.2s cubic-bezier(0.22, 1, 0.36, 1);
            --transition-fast: 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background 1.5s ease;
            background: linear-gradient(-45deg, #0a0a0a, #1a1a2e, #16213e, #0f3460);
            background-size: 400% 400%;
            animation: gradientBG 20s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header & Navigation */
        header {
            padding: 20px 0;
            position: relative;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            font-family: 'Quicksand', sans-serif;
            font-size: 2.8rem;
            font-weight: 800;
            background: linear-gradient(90deg, var(--warm-orange), var(--soft-yellow), var(--energetic-pink));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 1px;
        }

        .streak-counter {
            background: rgba(255, 154, 60, 0.15);
            border-radius: 50px;
            padding: 8px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            border: 1px solid rgba(255, 154, 60, 0.3);
        }

        .streak-counter .fire {
            color: var(--warm-orange);
            animation: pulse 2s infinite;
        }

        /* Main Dashboard Layout */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            margin-top: 20px;
        }

        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }

        /* Mood Input Section - Enhanced */
        .mood-input-section {
            background: rgba(35, 35, 45, 0.7);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        .mood-input-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--warm-orange), var(--soft-yellow), var(--calm-purple));
        }

        .input-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--soft-yellow);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mood-input-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .input-methods {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .method-btn {
            padding: 12px 24px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            font-family: 'Poppins', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .method-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
        }

        .method-btn.active {
            background: linear-gradient(90deg, var(--warm-orange), var(--cozy-red));
            border-color: transparent;
        }

        /* 3D Visualizer */
        .visualizer-container {
            background: rgba(10, 10, 15, 0.6);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            height: 400px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .visualizer-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--soft-yellow);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #mood3dCanvas {
            width: 100%;
            height: 300px;
            border-radius: 15px;
            background: rgba(0, 0, 0, 0.3);
        }

        /* Sidebar Features */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .feature-card {
            background: rgba(35, 35, 45, 0.7);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .feature-card h3 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--soft-yellow);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Sound Player */
        .sound-player {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .sound-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .sound-btn {
            padding: 12px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .sound-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .sound-btn.active {
            background: var(--calm-purple);
            border-color: transparent;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        /* Mood Journal */
        .journal-textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border-radius: 12px;
            background: rgba(20, 20, 30, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            font-family: 'Poppins', sans-serif;
            margin-bottom: 15px;
            resize: vertical;
        }

        /* Analytics Dashboard */
        .analytics-dashboard {
            background: rgba(35, 35, 45, 0.7);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .chart-container {
            background: rgba(20, 20, 30, 0.8);
            border-radius: 15px;
            padding: 20px;
            height: 300px;
        }

        /* Games Section */
        .games-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .game-card {
            background: rgba(35, 35, 45, 0.7);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: transform 0.3s ease;
        }

        .game-card:hover {
            transform: translateY(-5px);
        }

        .breathing-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 20px auto;
            border: 3px solid var(--peace-blue);
            animation: breathe 6s infinite ease-in-out;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.3); opacity: 1; }
        }

        /* Mood Timeline */
        .timeline-container {
            background: rgba(35, 35, 45, 0.7);
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .timeline {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 20px 0;
        }

        .timeline-item {
            min-width: 120px;
            background: rgba(20, 20, 30, 0.8);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -8px;
            width: 16px;
            height: 16px;
            background: var(--mood-color);
            border-radius: 50%;
            transform: translateY(-50%);
        }

        /* AI Coach */
        .ai-coach {
            background: rgba(35, 35, 45, 0.7);
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .coach-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--calm-purple), var(--peace-blue));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .coach-message {
            flex: 1;
        }

        .coach-options {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* Achievements */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .achievement-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .achievement-card.unlocked {
            background: rgba(255, 209, 102, 0.15);
            border: 1px solid rgba(255, 209, 102, 0.3);
        }

        .achievement-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(25, 25, 35, 0.95);
            border-radius: 15px;
            padding: 20px;
            max-width: 350px;
            z-index: 1000;
            border-left: 5px solid var(--alert-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateX(400px);
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            backdrop-filter: blur(10px);
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Footer */
        footer {
            margin-top: 50px;
            padding: 40px 20px;
            text-align: center;
            color: var(--text-dim);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            background: rgba(15, 15, 20, 0.5);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .input-methods {
                flex-direction: column;
            }
            
            .sound-options {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .ai-coach {
                flex-direction: column;
                text-align: center;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--warm-orange);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--cozy-red);
        }
    </style>
</head>
<body>
    <!-- Background Particles -->
    <div id="particles"></div>
    
    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo-section">
                <h1 class="logo">MoodScape Pro+</h1>
                <div class="streak-counter">
                    <i class="fas fa-fire fire"></i>
                    <span id="streakCount">0 Day Streak</span>
                </div>
            </div>
            
            <div class="user-actions">
                <button class="method-btn" id="voiceInputBtn">
                    <i class="fas fa-microphone"></i> Voice Input
                </button>
                <button class="method-btn" id="exportBtn">
                    <i class="fas fa-download"></i> Export Data
                </button>
                <button class="method-btn" id="themeBtn">
                    <i class="fas fa-palette"></i> Theme
                </button>
            </div>
        </header>

        <!-- Main Dashboard -->
        <div class="dashboard">
            <main class="main-content">
                <!-- Enhanced Mood Input -->
                <section class="mood-input-section">
                    <h2 class="input-title">
                        <i class="fas fa-brain"></i> How Are You Feeling Today?
                    </h2>
                    
                    <div class="mood-input-container">
                        <div class="input-methods">
                            <button class="method-btn active" data-method="text">
                                <i class="fas fa-keyboard"></i> Type
                            </button>
                            <button class="method-btn" data-method="voice">
                                <i class="fas fa-microphone"></i> Voice
                            </button>
                            <button class="method-btn" data-method="select">
                                <i class="fas fa-smile"></i> Select
                            </button>
                            <button class="method-btn" data-method="ai">
                                <i class="fas fa-robot"></i> AI Detect
                            </button>
                        </div>
                        
                        <div id="textInput" class="input-method active">
                            <div class="input-group">
                                <input type="text" id="moodText" placeholder="Describe your mood in detail...">
                                <button id="analyzeText" class="method-btn" style="background: var(--warm-orange);">
                                    <i class="fas fa-magic"></i> Analyze
                                </button>
                            </div>
                        </div>
                        
                        <div id="voiceInput" class="input-method" style="display: none;">
                            <div class="voice-status">
                                <div class="voice-visualizer" id="voiceVisualizer"></div>
                                <button id="startRecording" class="method-btn">
                                    <i class="fas fa-microphone"></i> Start Recording
                                </button>
                            </div>
                        </div>
                        
                        <div id="selectInput" class="input-method" style="display: none;">
                            <div class="mood-selector" id="moodSelector"></div>
                        </div>
                    </div>
                </section>

                <!-- 3D Mood Visualizer -->
                <section class="visualizer-container">
                    <h3 class="visualizer-title">
                        <i class="fas fa-cube"></i> 3D Mood Visualization
                    </h3>
                    <canvas id="mood3dCanvas"></canvas>
                </section>

                <!-- Analytics Dashboard -->
                <section class="analytics-dashboard">
                    <h3 class="input-title">
                        <i class="fas fa-chart-line"></i> Mood Analytics
                    </h3>
                    <div class="charts-grid">
                        <div class="chart-container">
                            <canvas id="moodChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="weeklyChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="timeChart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Mood Games -->
                <section class="games-section">
                    <div class="game-card">
                        <h4><i class="fas fa-wind"></i> Breathing Exercise</h4>
                        <div class="breathing-circle"></div>
                        <p>Follow the circle: Breathe in (expands), Hold, Breathe out</p>
                        <button class="method-btn" style="margin-top: 15px;">
                            <i class="fas fa-play"></i> Start Exercise
                        </button>
                    </div>
                    
                    <div class="game-card">
                        <h4><i class="fas fa-star"></i> Gratitude Practice</h4>
                        <div id="gratitudeList">
                            <input type="text" id="gratitudeInput" placeholder="One thing I'm grateful for..." style="width: 100%; margin-bottom: 10px;">
                            <button id="addGratitude" class="method-btn">Add +</button>
                            <div id="gratitudeItems" style="margin-top: 15px;"></div>
                        </div>
                    </div>
                    
                    <div class="game-card">
                        <h4><i class="fas fa-brain"></i> Mindful Minute</h4>
                        <div class="timer" style="font-size: 2rem; text-align: center; margin: 20px 0;">
                            <span id="mindfulTimer">60</span>s
                        </div>
                        <button id="startMindful" class="method-btn">
                            <i class="fas fa-play"></i> Start 60s
                        </button>
                    </div>
                </section>

                <!-- Mood Timeline -->
                <section class="timeline-container">
                    <h3 class="input-title">
                        <i class="fas fa-history"></i> Your Mood Journey
                    </h3>
                    <div class="timeline" id="moodTimeline"></div>
                </section>
            </main>

            <!-- Sidebar -->
            <aside class="sidebar">
                <!-- AI Mood Coach -->
                <div class="ai-coach">
                    <div class="coach-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="coach-message">
                        <p id="coachMessage">Welcome! I'm your AI mood coach. How can I help you today?</p>
                        <div class="coach-options">
                            <button class="method-btn small">Suggest Activity</button>
                            <button class="method-btn small">Analyze Pattern</button>
                        </div>
                    </div>
                </div>

                <!-- Ambient Sounds -->
                <div class="feature-card">
                    <h3><i class="fas fa-volume-up"></i> Ambient Sounds</h3>
                    <div class="sound-player">
                        <div class="sound-options">
                            <button class="sound-btn" data-sound="rain">
                                <i class="fas fa-cloud-rain"></i> Rain
                            </button>
                            <button class="sound-btn" data-sound="forest">
                                <i class="fas fa-tree"></i> Forest
                            </button>
                            <button class="sound-btn" data-sound="waves">
                                <i class="fas fa-water"></i> Ocean
                            </button>
                            <button class="sound-btn" data-sound="fireplace">
                                <i class="fas fa-fire"></i> Fireplace
                            </button>
                        </div>
                        <div class="volume-control">
                            <i class="fas fa-volume-down"></i>
                            <input type="range" id="volumeSlider" min="0" max="100" value="50" style="flex: 1;">
                            <i class="fas fa-volume-up"></i>
                        </div>
                    </div>
                </div>

                <!-- Mood Journal -->
                <div class="feature-card">
                    <h3><i class="fas fa-book"></i> Mood Journal</h3>
                    <textarea class="journal-textarea" id="journalEntry" placeholder="What's on your mind today? Write freely..."></textarea>
                    <div style="display: flex; gap: 10px;">
                        <button id="saveJournal" class="method-btn" style="flex: 1;">
                            <i class="fas fa-save"></i> Save
                        </button>
                        <button id="viewJournal" class="method-btn">
                            <i class="fas fa-eye"></i> View
                        </button>
                    </div>
                </div>

                <!-- Achievements -->
                <div class="feature-card">
                    <h3><i class="fas fa-trophy"></i> Achievements</h3>
                    <div class="achievements-grid" id="achievementsGrid"></div>
                </div>

                <!-- Quick Actions -->
                <div class="feature-card">
                    <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <button class="method-btn" id="musicBtn">
                            <i class="fas fa-music"></i> Music
                        </button>
                        <button class="method-btn" id="quoteBtn">
                            <i class="fas fa-quote-right"></i> Quote
                        </button>
                        <button class="method-btn" id="activityBtn">
                            <i class="fas fa-hiking"></i> Activity
                        </button>
                        <button class="method-btn" id="meditateBtn">
                            <i class="fas fa-spa"></i> Meditate
                        </button>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Footer -->
        <footer>
            <p>MoodScape Pro+ | Advanced Emotional Wellness Platform | Data is stored locally on your device</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                <button class="method-btn small" id="exportAll">Export All Data</button>
                <button class="method-btn small" id="resetData">Reset Data</button>
                <button class="method-btn small" id="privacyBtn">Privacy</button>
            </p>
        </footer>
    </div>

    <script>
        // Enhanced Mood data configuration
        const moods = [
            { id: 'joyful', name: 'Joyful', color: '#ff9a3c', icon: 'fas fa-laugh-beam', intensity: 4 },
            { id: 'calm', name: 'Calm', color: '#9d4edd', icon: 'fas fa-spa', intensity: 2 },
            { id: 'energetic', name: 'Energetic', color: '#ef476f', icon: 'fas fa-bolt', intensity: 5 },
            { id: 'cozy', name: 'Cozy', color: '#ffd166', icon: 'fas fa-home', intensity: 3 },
            { id: 'reflective', name: 'Reflective', color: '#118ab2', icon: 'fas fa-moon', intensity: 3 },
            { id: 'hopeful', name: 'Hopeful', color: '#06d6a0', icon: 'fas fa-seedling', intensity: 4 },
            { id: 'creative', name: 'Creative', color: '#ff4d8d', icon: 'fas fa-palette', intensity: 4 },
            { id: 'focused', name: 'Focused', color: '#7209b7', icon: 'fas fa-bullseye', intensity: 4 }
        ];

        // Achievements data
        const achievements = [
            { id: 'first_checkin', name: 'First Step', desc: 'Complete your first mood check-in', icon: 'ðŸ¥³', unlocked: true },
            { id: 'streak_3', name: 'Consistent', desc: '3-day check-in streak', icon: 'ðŸ”¥', unlocked: false },
            { id: 'streak_7', name: 'Week Warrior', desc: '7-day streak', icon: 'ðŸ†', unlocked: false },
            { id: 'journal_5', name: 'Reflective Soul', desc: '5 journal entries', icon: 'ðŸ“–', unlocked: false },
            { id: 'all_moods', name: 'Mood Explorer', desc: 'Try all mood types', icon: 'ðŸ—ºï¸', unlocked: false },
            { id: 'night_owl', name: 'Night Owl', desc: 'Check in after 10 PM', icon: 'ðŸŒ™', unlocked: false },
            { id: 'morning_person', name: 'Early Bird', desc: 'Check in before 8 AM', icon: 'ðŸŒ…', unlocked: false },
            { id: 'meditator', name: 'Zen Master', desc: 'Complete 5 meditation sessions', icon: 'ðŸ§˜', unlocked: false }
        ];

        // Sound data
        const sounds = {
            rain: { name: 'Rain', icon: 'fas fa-cloud-rain', url: '#' },
            forest: { name: 'Forest', icon: 'fas fa-tree', url: '#' },
            waves: { name: 'Ocean Waves', icon: 'fas fa-water', url: '#' },
            fireplace: { name: 'Fireplace', icon: 'fas fa-fire', url: '#' }
        };

        // App State
        let appState = {
            currentMood: null,
            moodHistory: [],
            journalEntries: [],
            achievements: [],
            streak: 0,
            lastCheckIn: null,
            settings: {
                volume: 50,
                theme: 'dark',
                notifications: true
            }
        };

        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            loadAppState();
            initializeUI();
            initializeCharts();
            initialize3DVisualizer();
            initializeVoiceRecognition();
            updateStreak();
            showNotification('Welcome to MoodScape Pro+! Your emotional wellness journey starts here.', 'info');
        });

        // Load app state from localStorage
        function loadAppState() {
            const saved = localStorage.getItem('moodscapePro');
            if (saved) {
                appState = JSON.parse(saved);
                updateAchievementsDisplay();
                updateTimeline();
                updateJournalDisplay();
            }
        }

        // Save app state to localStorage
        function saveAppState() {
            localStorage.setItem('moodscapePro', JSON.stringify(appState));
        }

        // Initialize UI components
        function initializeUI() {
            // Initialize mood selector
            const moodSelector = document.getElementById('moodSelector');
            moods.forEach(mood => {
                const btn = document.createElement('button');
                btn.className = 'method-btn';
                btn.innerHTML = `<i class="${mood.icon}"></i> ${mood.name}`;
                btn.style.borderColor = mood.color;
                btn.addEventListener('click', () => selectMood(mood.id));
                moodSelector.appendChild(btn);
            });

            // Initialize input method switcher
            document.querySelectorAll('.method-btn[data-method]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const method = e.target.closest('button').dataset.method;
                    switchInputMethod(method);
                });
            });

            // Initialize sound buttons
            document.querySelectorAll('.sound-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const sound = e.target.closest('button').dataset.sound;
                    playSound(sound);
                });
            });

            // Initialize achievement display
            updateAchievementsDisplay();

            // Initialize event listeners
            document.getElementById('analyzeText').addEventListener('click', analyzeTextMood);
            document.getElementById('startRecording').addEventListener('click', toggleRecording);
            document.getElementById('saveJournal').addEventListener('click', saveJournalEntry);
            document.getElementById('addGratitude').addEventListener('click', addGratitudeItem);
            document.getElementById('startMindful').addEventListener('click', startMindfulTimer);
            document.getElementById('exportAll').addEventListener('click', exportAllData);
            document.getElementById('resetData').addEventListener('click', resetAllData);
            
            // Add more event listeners...
        }

        // Switch between input methods
        function switchInputMethod(method) {
            // Update active button
            document.querySelectorAll('.method-btn[data-method]').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.method-btn[data-method="${method}"]`).classList.add('active');

            // Show/hide input areas
            document.querySelectorAll('.input-method').forEach(el => {
                el.style.display = 'none';
            });
            document.getElementById(`${method}Input`).style.display = 'block';
        }

        // Analyze text mood input
        function analyzeTextMood() {
            const text = document.getElementById('moodText').value;
            if (!text.trim()) {
                showNotification('Please enter how you are feeling', 'warning');
                return;
            }

            // Simple AI mood detection
            const detectedMood = detectMoodFromText(text);
            selectMood(detectedMood);
            
            // Show AI response
            const aiResponse = generateAIResponse(detectedMood, text);
            updateCoachMessage(aiResponse);
            
            showNotification(`Mood detected: ${detectedMood}`, 'success');
        }

        // Simple mood detection from text
        function detectMoodFromText(text) {
            const textLower = text.toLowerCase();
            const moodScores = {};
            
            // Score keywords
            moods.forEach(mood => {
                let score = 0;
                const keywords = getMoodKeywords(mood.id);
                keywords.forEach(keyword => {
                    if (textLower.includes(keyword)) score += 2;
                });
                moodScores[mood.id] = score;
            });

            // Fallback: detect positive/negative sentiment
            const positiveWords = ['good', 'great', 'happy', 'excited', 'wonderful', 'amazing'];
            const negativeWords = ['bad', 'sad', 'angry', 'upset', 'tired', 'stressed'];
            
            positiveWords.forEach(word => {
                if (textLower.includes(word)) moodScores['joyful'] += 3;
            });
            
            negativeWords.forEach(word => {
                if (textLower.includes(word)) moodScores['reflective'] += 3;
            });

            // Return mood with highest score
            return Object.keys(moodScores).reduce((a, b) => moodScores[a] > moodScores[b] ? a : b);
        }

        function getMoodKeywords(moodId) {
            const keywords = {
                joyful: ['happy', 'joy', 'excited', 'great', 'wonderful', 'amazing', 'good'],
                calm: ['calm', 'peaceful', 'relaxed', 'chill', 'serene', 'tranquil'],
                energetic: ['energetic', 'excited', 'active', 'pumped', 'motivated', 'energized'],
                cozy: ['cozy', 'comfortable', 'warm', 'safe', 'snug', 'homey'],
                reflective: ['thoughtful', 'reflective', 'contemplative', 'deep', 'pensive', 'sad'],
                hopeful: ['hopeful', 'optimistic', 'positive', 'looking forward', 'excited for'],
                creative: ['creative', 'inspired', 'artistic', 'imaginative', 'innovative'],
                focused: ['focused', 'concentrated', 'attentive', 'productive', 'determined']
            };
            return keywords[moodId] || [];
        }

        // Select a mood
        function selectMood(moodId) {
            const mood = moods.find(m => m.id === moodId);
            if (!mood) return;

            appState.currentMood = mood;
            appState.moodHistory.push({
                mood: mood,
                timestamp: new Date().toISOString(),
                intensity: mood.intensity
            });

            // Update streak
            updateStreak();

            // Update 3D visualizer
            update3DVisualizer(mood);

            // Update charts
            updateCharts();

            // Update timeline
            updateTimeline();

            // Check achievements
            checkAchievements();

            // Save state
            saveAppState();

            // Show notification
            showNotification(`Recorded ${mood.name} mood!`, 'success');
        }

        // Initialize 3D visualizer
        function initialize3DVisualizer() {
            const canvas = document.getElementById('mood3dCanvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // Initial visualization
            update3DVisualizer(moods[0]);
        }

        function update3DVisualizer(mood) {
            const canvas = document.getElementById('mood3dCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            // Create gradient background
            const gradient = ctx.createRadialGradient(
                width/2, height/2, 0,
                width/2, height/2, width/2
            );
            gradient.addColorStop(0, `${mood.color}40`);
            gradient.addColorStop(1, 'transparent');
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, height);
            
            // Draw particles
            const particleCount = 50 + mood.intensity * 20;
            for (let i = 0; i < particleCount; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = Math.random() * 5 + 2;
                const opacity = Math.random() * 0.5 + 0.3;
                
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fillStyle = `${mood.color}${Math.floor(opacity * 255).toString(16)}`;
                ctx.fill();
                
                // Add glow effect
                ctx.shadowColor = mood.color;
                ctx.shadowBlur = 10;
                ctx.fill();
                ctx.shadowBlur = 0;
            }
            
            // Draw central orb
            const time = Date.now() * 0.001;
            const pulse = Math.sin(time * 2) * 10 + 50;
            
            ctx.beginPath();
            ctx.arc(width/2, height/2, pulse, 0, Math.PI * 2);
            const orbGradient = ctx.createRadialGradient(
                width/2, height/2, 0,
                width/2, height/2, pulse
            );
            orbGradient.addColorStop(0, mood.color);
            orbGradient.addColorStop(1, `${mood.color}00`);
            ctx.fillStyle = orbGradient;
            ctx.fill();
        }

        // Initialize charts
        function initializeCharts() {
            // Mood distribution chart
            const moodChart = new Chart(document.getElementById('moodChart'), {
                type: 'doughnut',
                data: {
                    labels: moods.map(m => m.name),
                    datasets: [{
                        data: moods.map(() => Math.random() * 10),
                        backgroundColor: moods.map(m => m.color),
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    }
                }
            });

            // Weekly trend chart
            const weeklyChart = new Chart(document.getElementById('weeklyChart'), {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Mood Score',
                        data: [6, 7, 8, 5, 9, 7, 8],
                        borderColor: '#ff9a3c',
                        backgroundColor: '#ff9a3c20',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { min: 1, max: 10 }
                    }
                }
            });

            // Time of day chart
            const timeChart = new Chart(document.getElementById('timeChart'), {
                type: 'bar',
                data: {
                    labels: ['6AM', '9AM', '12PM', '3PM', '6PM', '9PM', '12AM'],
                    datasets: [{
                        label: 'Average Mood',
                        data: [7, 8, 6, 5, 7, 8, 6],
                        backgroundColor: moods.map(m => m.color)
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { min: 1, max: 10 }
                    }
                }
            });

            window.charts = { moodChart, weeklyChart, timeChart };
        }

        function updateCharts() {
            if (!window.charts) return;
            
            // Update mood chart with actual data
            const moodCounts = moods.map(mood => 
                appState.moodHistory.filter(h => h.mood.id === mood.id).length
            );
            
            window.charts.moodChart.data.datasets[0].data = moodCounts;
            window.charts.moodChart.update();
        }

        // Voice recognition
        function initializeVoiceRecognition() {
            if ('webkitSpeechRecognition' in window) {
                window.recognition = new webkitSpeechRecognition();
                window.recognition.continuous = false;
                window.recognition.interimResults = false;
                
                window.recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('moodText').value = transcript;
                    analyzeTextMood();
                };
                
                window.recognition.onerror = (event) => {
                    showNotification('Voice recognition error: ' + event.error, 'error');
                };
            }
        }

        function toggleRecording() {
            if (!window.recognition) {
                showNotification('Voice recognition not supported in your browser', 'warning');
                return;
            }
            
            const btn = document.getElementById('startRecording');
            if (btn.textContent.includes('Start')) {
                window.recognition.start();
                btn.innerHTML = '<i class="fas fa-stop"></i> Stop Recording';
                showNotification('Listening... Speak now!', 'info');
            } else {
                window.recognition.stop();
                btn.innerHTML = '<i class="fas fa-microphone"></i> Start Recording';
            }
        }

        // Journal functionality
        function saveJournalEntry() {
            const text = document.getElementById('journalEntry').value;
            if (!text.trim()) {
                showNotification('Please write something in your journal', 'warning');
                return;
            }
            
            const entry = {
                text: text,
                mood: appState.currentMood,
                timestamp: new Date().toISOString()
            };
            
            appState.journalEntries.push(entry);
            saveAppState();
            
            document.getElementById('journalEntry').value = '';
            showNotification('Journal entry saved!', 'success');
            
            // Check achievement
            if (appState.journalEntries.length >= 5) {
                unlockAchievement('journal_5');
            }
        }

        // Achievements system
        function updateAchievementsDisplay() {
            const grid = document.getElementById('achievementsGrid');
            grid.innerHTML = '';
            
            achievements.forEach(achievement => {
                const card = document.createElement('div');
                card.className = `achievement-card ${achievement.unlocked ? 'unlocked' : ''}`;
                card.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <h4>${achievement.name}</h4>
                    <p style="font-size: 0.8rem; opacity: 0.8;">${achievement.desc}</p>
                    ${achievement.unlocked ? '<small style="color: #ffd166;">âœ“ Unlocked</small>' : '<small style="opacity: 0.5;">Locked</small>'}
                `;
                grid.appendChild(card);
            });
        }

        function checkAchievements() {
            const now = new Date();
            const hour = now.getHours();
            
            // Check for night owl
            if (hour >= 22 && !achievements.find(a => a.id === 'night_owl').unlocked) {
                unlockAchievement('night_owl');
            }
            
            // Check for morning person
            if (hour < 8 && !achievements.find(a => a.id === 'morning_person').unlocked) {
                unlockAchievement('morning_person');
            }
            
            // Check if all moods tried
            const triedMoods = new Set(appState.moodHistory.map(h => h.mood.id));
            if (triedMoods.size >= moods.length && !achievements.find(a => a.id === 'all_moods').unlocked) {
                unlockAchievement('all_moods');
            }
        }

        function unlockAchievement(achievementId) {
            const achievement = achievements.find(a => a.id === achievementId);
            if (achievement && !achievement.unlocked) {
                achievement.unlocked = true;
                updateAchievementsDisplay();
                showNotification(`ðŸŽ‰ Achievement Unlocked: ${achievement.name}!`, 'success');
                saveAppState();
            }
        }

        // Streak system
        function updateStreak() {
            const now = new Date();
            const today = now.toDateString();
            
            if (!appState.lastCheckIn) {
                appState.streak = 1;
            } else {
                const lastDate = new Date(appState.lastCheckIn);
                const lastDay = lastDate.toDateString();
                
                if (today === lastDay) {
                    // Already checked in today
                    return;
                } else if (isYesterday(lastDate, now)) {
                    // Consecutive day
                    appState.streak++;
                } else {
                    // Streak broken
                    appState.streak = 1;
                }
            }
            
            appState.lastCheckIn = now.toISOString();
            
            // Update display
            document.getElementById('streakCount').textContent = `${appState.streak} Day Streak`;
            
            // Check streak achievements
            if (appState.streak >= 3) {
                unlockAchievement('streak_3');
            }
            if (appState.streak >= 7) {
                unlockAchievement('streak_7');
            }
            
            saveAppState();
        }

        function isYesterday(date1, date2) {
            const oneDay = 24 * 60 * 60 * 1000;
            return Math.abs(date1 - date2) <= oneDay;
        }

        // Timeline
        function updateTimeline() {
            const timeline = document.getElementById('moodTimeline');
            timeline.innerHTML = '';
            
            // Show last 7 days
            const recentHistory = appState.moodHistory.slice(-7);
            
            recentHistory.forEach(entry => {
                const date = new Date(entry.timestamp);
                const item = document.createElement('div');
                item.className = 'timeline-item';
                item.style.setProperty('--mood-color', entry.mood.color);
                item.innerHTML = `
                    <div style="color: ${entry.mood.color}; font-size: 1.5rem;">
                        <i class="${entry.mood.icon}"></i>
                    </div>
                    <div style="font-weight: 600; margin: 5px 0;">${entry.mood.name}</div>
                    <div style="font-size: 0.8rem; opacity: 0.7;">
                        ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                    </div>
                `;
                timeline.appendChild(item);
            });
        }

        // Gratitude practice
        function addGratitudeItem() {
            const input = document.getElementById('gratitudeInput');
            const text = input.value.trim();
            
            if (!text) {
                showNotification('Please enter something you\'re grateful for', 'warning');
                return;
            }
            
            const itemsDiv = document.getElementById('gratitudeItems');
            const item = document.createElement('div');
            item.style.cssText = `
                background: rgba(255, 209, 102, 0.1);
                border-radius: 8px;
                padding: 10px;
                margin: 5px 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            `;
            item.innerHTML = `
                <span>${text}</span>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; color: #ff6b6b; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            itemsDiv.appendChild(item);
            input.value = '';
            
            // Add to local storage
            const gratitudes = JSON.parse(localStorage.getItem('gratitudes') || '[]');
            gratitudes.push({ text, date: new Date().toISOString() });
            localStorage.setItem('gratitudes', JSON.stringify(gratitudes));
        }

        // Mindful minute timer
        function startMindfulTimer() {
            const timerEl = document.getElementById('mindfulTimer');
            const btn = document.getElementById('startMindful');
            let timeLeft = 60;
            
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-pause"></i> Meditating...';
            
            const timer = setInterval(() => {
                timeLeft--;
                timerEl.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    btn.disabled = false;
                    btn.innerHTML = '<i class="fas fa-play"></i> Start 60s';
                    timerEl.textContent = '60';
                    showNotification('ðŸŽ‰ Mindful minute complete! Well done!', 'success');
                    
                    // Track meditation sessions
                    const sessions = parseInt(localStorage.getItem('meditationSessions') || '0') + 1;
                    localStorage.setItem('meditationSessions', sessions.toString());
                    
                    if (sessions >= 5) {
                        unlockAchievement('meditator');
                    }
                }
            }, 1000);
        }

        // Sound player
        function playSound(soundType) {
            // In a real app, you would play actual audio files
            showNotification(`Playing ${sounds[soundType].name} sounds...`, 'info');
            
            // Update active sound button
            document.querySelectorAll('.sound-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.sound-btn[data-sound="${soundType}"]`).classList.add('active');
        }

        // AI Coach messages
        function updateCoachMessage(message) {
            document.getElementById('coachMessage').textContent = message;
        }

        function generateAIResponse(moodId, text) {
            const responses = {
                joyful: [
                    "That's wonderful to hear! Your positive energy is contagious.",
                    "Joy is such a beautiful state to be in. What's making you feel this way?",
                    "Happiness looks great on you! Want to explore activities to maintain this mood?"
                ],
                calm: [
                    "Peace and tranquility - what a beautiful state to be in.",
                    "I sense a deep calm in you. This is perfect for reflection.",
                    "Your calm energy creates space for clarity and insight."
                ],
                reflective: [
                    "Deep thoughts can lead to profound insights. Want to journal about this?",
                    "Reflection is the first step toward understanding. How can I help?",
                    "This contemplative state is perfect for personal growth."
                ]
            };
            
            const moodResponses = responses[moodId] || [
                "Thank you for sharing. How can I support you today?",
                "I'm here to listen. Tell me more about how you're feeling."
            ];
            
            return moodResponses[Math.floor(Math.random() * moodResponses.length)];
        }

        // Data export
        function exportAllData() {
            const data = {
                appState,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `moodscape-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Data exported successfully!', 'success');
        }

        // Reset all data
        function resetAllData() {
            if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
                localStorage.clear();
                location.reload();
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            
            const colors = {
                info: '#118ab2',
                success: '#06d6a0',
                warning: '#ffd166',
                error: '#ef476f'
            };
            
            notification.style.borderLeftColor = colors[type] || colors.info;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: start; gap: 10px;">
                    <div style="font-size: 1.2rem;">
                        ${type === 'success' ? 'ðŸŽ‰' : type === 'error' ? 'âš ï¸' : 'ðŸ’¡'}
                    </div>
                    <div style="flex: 1;">${message}</div>
                    <button onclick="this.parentElement.parentElement.remove()" 
                            style="background: none; border: none; color: var(--text-dim); cursor: pointer;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Show animation
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 500);
            }, 5000);
        }

        // Add missing functions
        function updateJournalDisplay() {
            // Implementation for displaying journal entries
        }

        // Add more interactive features...
        
        // Initialize background particles
        function initParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: fixed;
                    width: ${Math.random() * 5 + 2}px;
                    height: ${Math.random() * 5 + 2}px;
                    background: ${moods[Math.floor(Math.random() * moods.length)].color};
                    border-radius: 50%;
                    opacity: ${Math.random() * 0.3 + 0.1};
                    z-index: -1;
                    top: ${Math.random() * 100}vh;
                    left: ${Math.random() * 100}vw;
                `;
                container.appendChild(particle);
                
                // Animate particle
                animateParticle(particle);
            }
        }

        function animateParticle(element) {
            let x = parseFloat(element.style.left);
            let y = parseFloat(element.style.top);
            let dx = (Math.random() - 0.5) * 0.3;
            let dy = (Math.random() - 0.5) * 0.3;
            
            function move() {
                x += dx;
                y += dy;
                
                // Bounce off edges
                if (x < 0 || x > 100) dx *= -1;
                if (y < 0 || y > 100) dy *= -1;
                
                element.style.left = `${x}vw`;
                element.style.top = `${y}vh`;
                
                requestAnimationFrame(move);
            }
            
            move();
        }

        // Initialize particles on load
        initParticles();

        // Periodic coach updates
        setInterval(() => {
            if (appState.currentMood) {
                const messages = [
                    "How is your current mood evolving?",
                    "Would you like to try a quick mindfulness exercise?",
                    "I notice you've been checking in regularly. Great consistency!",
                    "Your emotional awareness is growing with each check-in."
                ];
                
                const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                updateCoachMessage(randomMessage);
            }
        }, 30000); // Every 30 seconds

        // Daily reminder (simulated)
        setInterval(() => {
            const now = new Date();
            const hours = now.getHours();
            
            // Only show during reasonable hours
            if (hours >= 9 && hours <= 21) {
                const lastCheckIn = appState.lastCheckIn ? new Date(appState.lastCheckIn) : null;
                const today = now.toDateString();
                
                if (!lastCheckIn || lastCheckIn.toDateString() !== today) {
                    showNotification('ðŸ’­ Remember to check in with your mood today!', 'info');
                }
            }
        }, 3600000); // Check every hour

        // Background gradient animation
        let gradientAngle = 0;
        setInterval(() => {
            gradientAngle = (gradientAngle + 0.1) % 360;
            document.body.style.background = `linear-gradient(${gradientAngle}deg, #0a0a0a, #1a1a2e, #16213e, #0f3460)`;
        }, 50);

    </script>
</body>
</html>